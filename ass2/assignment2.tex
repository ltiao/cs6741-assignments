\documentclass[12pt, a4paper]{article}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{epsfig}
\usepackage[margin=1in]{geometry}
%\usepackage{enumitem}
\usepackage{enumerate}
\usepackage{graphicx}
\usepackage{tikz}
\usetikzlibrary{automata, positioning}
% \usepackage{pgfplots}
\usepackage{caption}
\usepackage{mathtools}
\usepackage{titling}
\usepackage[lined,boxed,commentsnumbered,vlined]{algorithm2e}

\usepackage{todonotes}

% For writing code:
\usepackage{fancyvrb}
\DefineVerbatimEnvironment{code}{Verbatim}{fontsize=\small}
	\def\showvrb#1{%
	\texttt{\detokenize{#1}}%
}

\usepackage{cleveref}

\linespread{1.1}
\setlength{\parindent}{0pt} % Sets the indent length to 0
\setlength{\parskip}{8pt plus 1pt minus 1pt} % paragraph vertical distance

% \everymath{\displaystyle} % displays inline math as displaymath

% make title smaller
% \pretitle{\begin{center}\large}
% \posttitle{\end{center}}
\preauthor{\begin{center}\normalsize}
\postauthor{\end{center}}
\predate{\begin{center}\footnotesize}
\postdate{\end{center}}
\setlength{\droptitle}{-60pt}

\title{Assignment 2 - Theoretical Assignment \\
 COMP6741: Parameterized and Exact Computation}
\author{Edward Lee, Han Zhao, Louis Tiao}

%%%%%%%%%%%%%%%%%%%%%%%%%%
% Commonly used theorems %
%%%%%%%%%%%%%%%%%%%%%%%%%%

% Use roman for text - numbering follows onwards
\theoremstyle{definition}
\newtheorem{defn}{Definition}[section]
\newtheorem{them}{Theorem}[section]
\newtheorem{lem}{Lemma}[them]
\newtheorem{prop}[them]{Proposition}
\newtheorem{corr}[them]{Corollary}
\newtheorem{corrr}{Corollary}[them] %for consistency issues
% examples follow different numbering
\newtheorem{eg}{Example}[section]
\newtheorem{egg}[them]{Example}
\newtheorem*{themf}{Theorem 5.0}
\newtheorem*{themm}{Theorem}

%%%%%%%%%%%%%
% Shortcuts %
%%%%%%%%%%%%%

\newcommand{\Q}{\mathbb{Q}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\F}{\mathbb{F}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\D}{\mathbb{D}}

\newcommand{\mcC}{\mathcal{C}}
\newcommand{\mcN}{\mathcal{N}}
\newcommand{\mcE}{\mathcal{E}}
\newcommand{\mcP}{\mathcal{P}}
\newcommand{\mcF}{\mathcal{F}}
\newcommand{\mcS}{\mathcal{S}}
\newcommand{\mcA}{\mathcal{A}}
\newcommand{\mcB}{\mathcal{B}}
\newcommand{\mcX}{\mathcal{X}}
\newcommand{\mcL}{\mathcal{L}}
\newcommand{\mcH}{\mathcal{H}}
\newcommand{\mcl}{\mathcal{l}}
\newcommand{\mcU}{\mathcal{U}}

\newcommand{\mcI}{\mathcal{I}}
\newcommand{\mcO}{\mathcal{O}}

\newcommand{\bfe}{\mathbf{e}}
\newcommand{\mbf}{\mathbf}

\newcommand{\ran}{\mbox{Ran}}
 
\newcommand{\al}{\alpha}
\newcommand{\s}{\sigma}
\newcommand{\ep}{\epsilon}
\newcommand{\dl}{\delta}
\newcommand{\sg}{\sigma}

\newcommand{\bs}{\backslash}
\newcommand{\n}{\\}
\newcommand{\ol}{\overline}

%%%%%%%%%%%%%%%%%%%%%%%%%
% Standard big brackets %
%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\floor}[1]{\left\lfloor{#1}\right\rfloor}
\newcommand{\ceil}[1]{\left\lceil{#1}\right\rceil}
\newcommand{\bbA}[1]{\left({#1}\right)}
\newcommand{\bbB}[1]{\left[{#1}\right]}
\newcommand{\bbC}[1]{\left\{{#1}\right\}}

%%%%%%%%%%%%%%%%%%
% Start Document %
%%%%%%%%%%%%%%%%%%

\begin{document}
\maketitle

\todo{Consistency between British and American spelling (i.e. colour vs. color) Edward: Let's go with American? Serge's questions use color}
\todo{Spellcheck}

\section*{Preliminaries}

For completeness and later reference, we restate the \textsc{Packing}, $d$-\textsc{Packing}, \#\textsc{Packing} and \textsc{Packing Coloring} problems presented in this assignment.

For an integer $d \geq 0$, a \emph{d-packing} in a graph $G = (V,E)$ is a subset of vertices $S \subseteq V$ such that the distance between any two vertices in $S$ is at least $d$ + 1 in $G$. Denote $d(u,v)$ as the distance between $u,v \in V$.

\begin{algorithm}[H]
\textsc{Packing\n}
\begin{tabular}{l l}
 Input:    & A graph $G$, an integer $d \geq 0$, and an integer $k \geq 0$ \n
 Question: & Does $G$ have a $d$-packing of size $k$? \n
\end{tabular}	
\end{algorithm}

For a fixed integer $d$, 

\begin{algorithm}[H]
\textsc{$d$-Packing\n}
\begin{tabular}{l l}
 Input:    & A graph $G$, and an integer $k \geq 0$ \n
 Question: & Does $G$ have a $d$-packing of size $k$? \n
\end{tabular}	
\end{algorithm}

The counting variant requires the output of the number of $d$-packings in $G$

\begin{algorithm}[H]
\textsc{\#Packing\n}
\begin{tabular}{l l}
 Input:    & A graph $G$, and an integer $d \geq 0$\n
 Question: & The number of $d$-packings in $G$ \n
\end{tabular}	
\end{algorithm}

For a sequence of $k$ non-negative integers $D = (d_1,...,d_k)$, a \emph{D-packing coloring} of a graph $G = (V,E)$ is a partition of the vertex set $V$ into $k$ disjoint sets of vertices, $(S_1,...,S_k)$, such that $S_i$ is a $d_i$-packing in $G$ for each $i \in \{1,...,k\}$. The \textsc{Packing Coloring} problem is defined below

\begin{algorithm}[H]
\textsc{Packing Coloring\n}
\begin{tabular}{l l}
 Input:    & A graph $G$, an integer $k \geq 1$, and a sequence of non-negative integers $D = (d_1,...,d_k)$ \n
 Question: & Does $G$ have a $D$-packing coloring? \n
\end{tabular}	
\end{algorithm}

\clearpage

\section{\#\sc Packing}

\todo{Formalize and Proofread}

Consider a graph $G = (V, E)$ and let $n = |V|$.

First note that in any graph, the distance between any two distinct vertices is at least 1. Therefore, any subset of vertices $S \subseteq V$ is a $0$-packing, of which there are $2^n$. So for $d=0$, we need only calculate $|V|$ and $2^{|V|}$, which can be done in \todo{Why was your previous bound so pessimistic? Edward: No reason, I just wanted to cover bases. Linear is fine. $n^{\mcO(1)}$}
 $\mcO(n)$ time and space.

Next observe that in an independent set, the distance between any two distinct vertices is at least 2. Therefore, any independent set of $G$ is a $1$-packing. Denote \texttt{\#Indep-set} the polynomial space and $\mcO^*(1.2377^n)$ time branching algorithm of Wahlstr\"{o}m \cite{Dahllof2005,Wahlstr2008} that counts the number of independent sets in any graph. Then for $d=1$, we simply run \texttt{\#Indep-set} on $G$ using polynomial space, by virtue of the fact that \texttt{\#Indep-set} is a polynomial space branching algorithm.

For $d \geq 2$, we create a new graph $G'$ by adding edges between all pairs of distinct vertices that are of distance less than $d+1$ apart. Then for any pair of distinct vertices that are not adjacent in $G'$, the distance between them in $G$ must be at least $d+1$. It immediately follows that a subset of vertices is an independent set of $G'$ if and only if it is a $d$-packing of $G$.

We compute the graph $G'$ in polynomial time and space by performing a depth-limited search (limited in $d+1$) for pairs of vertices of distance less than $d+1$ apart and inserting new edges between them. We then run \texttt{\#Indep-set} on $G'$ and output its result. Since we have a polynomial time and space reduction and a polynomial space and $\mcO^*(1.2377^n)$ time branching algorithm which solves our reduced instance, we also have a polynomial space and $\mcO^*(1.2377^n)$ time branching algorithm in this case.

We summarize the above in \cref{algo:num_packing} and denote it as \texttt{\#Packing}.

\begin{algorithm}[H]
\caption{\texttt{\#Packing}}          % give the algorithm a caption
\label{algo:num_packing} 
\texttt{\#Packing\n}
\begin{tabular}{l l}
 Input:  & ($G,d$) \n
 Output: & Number of $d$-packings in $G$ \n
\end{tabular}	

\If{$d = 0$}{
	\textbf{return} $2^n$
}
\If{$d = 1$}{
	\textbf{return} \texttt{\#Indep-set}($G$)
}
\If{$d \geq 2$}{
	Let $G' = (V,E')$ where $E' = E \cup E^*$ and $E^* = \{ uv : d_G(u,v) \leq d \}$\n
	\textbf{return} \texttt{\#Indep-set}($G'$)
}

\end{algorithm}

Finally, we see that in all cases (i.e. for all $d \ge 0$), \texttt{\#Packing} runs in polynomial space and $\mcO^*(1.2377^n)$ time.

\section{\sc Packing Coloring  (\textnormal{Exponential space})}

First note that a $k$-coloring of a graph is a special case of a $D$-packing coloring 
where $D = (d_1, d_2, \dotsc, d_k) = (1, 1, \dotsc, 1)$. As such, we can consider extending
the solution to the \textsc{Coloring} problem to solve the \textsc{Packing Coloring} problem.

Recall that a $k$-coloring of a graph $G = (V, E)$ corresponds to a partition of $V$ into $k$ independent sets. So a $k$-coloring is a $k$-partition of the set system $(V, \mcI)$ where $\mcI$ is the set of all independent sets of $G$. In fact, obtaining $k$-cover $(I_1, \dotsc, I_k)$ of $(V, \mcI)$ would suffice since we can easily obtain a $k$-partition of $(V, \mcI)$ (and hence $k$-coloring of $G$) by removing $\bigcup_{i=1}^{j-1} I_i$ from $I_j$ for $j \in \{1, \dotsc, k\}$.

Now consider the \textsc{Packing Coloring} problem. Denote $\mcP_i$ as the set of all $d_i$-packings of $G$ and $\mcP = \bigcup_{i=1}^{k} \mcP_i$. Then a graph $G = (V, E)$ has a $(d_1, \dotsc, d_k)$-packing coloring if and only if there exists a $k$-cover $(S_1, \dotsc, S_k)$ of $(V, \mcP)$ such that $S_i$ is a $d_i$-packing. We can obtain $k$-partition (and hence a $D$-packing coloring of $G$) as before, since like independent sets, $d$-packings are closed under set difference.

Let $U$ be the set of tuples $(S_1, \dotsc, S_k)$, where each $S_i$ is a $d_i$-packing and $A_v = \{ (S_1, \dotsc, S_k) \in U : v \in \bigcup_{i=1}^{k} S_i\}$. Clearly $G$ has a $D$-packing coloring if and only if $\left | \bigcap_{v \in V} A_v \right | > 0$.

To compute $\left | \bigcap_{v \in V} A_v \right |$, we use the inclusion-exclusion theorem (c.f. Theorem 4.2 in \cite{Fomin2010}):
\begin{equation} \label{eq:incl_excl}
	\left | \bigcap_{v \in V} A_v \right | = \sum_{S \subseteq V} (-1)^{|S|} \left | \bigcap_{v \in S} \overline{A_v} \right | 
\end{equation}

So by extension, we simply need to compute 
\begin{align*}
	\left | \bigcap_{v \in S} \overline{A_v} \right | &= \left | \{ (S_1, \dotsc, S_k) \in U : S_1, \dotsc, S_k \subseteq V \setminus S \} \right | \\
													  &= \prod_{i=1}^{k} p(V \setminus S, d_i)
\end{align*}

where $p(X, d)$ is the number of $d$-packings in $G[X]$ (the subgraph induced by vertex subset $X$) and can be defined by the following dynamic programming recurrence:
\begin{align*}
	p(\emptyset, d) &= 1 \\
	p(X, d) &= \sum_{v \in X} p(X \setminus {v}, d) + p(X \setminus N_G^d[v], d)   
\end{align*}

(n.b. $N_G^i[v]$ denotes the closed $i$th neighborhood of $v$, that is, $u \in N_G^i[v]$ iff $d(u, v) \leq i$.) The table for $p(X, d)$ is filled by increasing cardinalities of $X$ and therefore we compute it in $\mcO^*(2^n)$ time and space. 

Finally, we evaluate

\begin{equation} \label{eq:incl_excl_final}
	\left | \bigcap_{v \in V} A_v \right | 
	= \sum_{S \subseteq V} (-1)^{|S|} \left | \bigcap_{v \in S} \overline{A_v} \right | 
	= \sum_{S \subseteq V} (-1)^{|S|} \prod_{i=1}^{k} p(V \setminus S, d_i)
\end{equation}

in $\mcO^*(2^n)$ time and space. We can decide whether $G$ has a $D$-packing coloring by checking that $G$ has at least one $D$-packing coloring ($\left | \bigcap_{v \in V} A_v \right | > 0$). Therefore, \textsc{Packing Coloring} can be solved in $\mcO^*(2^n)$ time and space.

\section{\sc Packing Coloring (\textnormal{Polynomial space})}

We incorporate the algorithm \texttt{\#Packing} from (1) that counts the number of $d$-packings in a given graph $G$ and integer $d \ge 0$ in $\mcO^*(1.2377^n)$ time and polynomial space to modify \cref{eq:incl_excl_final} to be
\begin{equation*}
	\left | \bigcap_{v \in V} A_v \right | 
	= \sum_{S \subseteq V} (-1)^{|S|} \prod_{i=1}^{k} \texttt{\#Packing}(V \setminus S, d_i)
\end{equation*}

Then, we obtain a polynomial space algorithm for \textsc{Packing Coloring} with running time
\begin{equation*}
	\sum_{S\subseteq V} \mcO^*(1.2377^{n-|S|}) = \sum_{s=0}^n \binom{n}{s} \mcO^*(1.2377^{n-s}) = \mcO^*(2.2377^n)
\end{equation*}

Therefore, \textsc{Packing Coloring} can be solved in $\mcO^*(2.2377^n)$ time and polynomial space.

\section{\sc Packing \textnormal{is FPT for parameter $k + d + \Delta (G)$} }

\todo{Formalize and Proofread}

From (1) we can reduce \textsc{Packing} to \textsc{Independent set} in poly-time with parameter $d$. We know that Independent set and Vertex cover can easily be reduced, but with a parameter $k$, Independent set is $W[1]$-hard and not FPT since we are looking for a vertex cover of size $n-k$. However, since we have $\Delta(G)$ as a parameter, we just run \textsc{Vertex Cover} with size $\Delta(G) \times k$, which is still FPT in parameter $k + d + \Delta(G)$.

\section{$d$-\sc Packing \textnormal{is $W[1]$-hard for parameter $k$}}

\todo{Formalize and Proofread}

We show that the $d$-\textsc{Packing} problem is $W[1]$-hard for parameter $k$ by providing a parameterized reduction from a well-known $W[1]$-hard problem, namely, \textsc{Independent Set}.	

\textbf{Construction:} Let $(G = (V,E) ,k)$ be an instance for $\textsc{Independent Set}$. We construct an instance $(G' = (V',E'),k')$ for $d-$\textsc{Packing}. First set $k' \leftarrow k$. 

For odd $d = 2m+1$ where $m$ is a natural number, for every vertex $v \in V$ we connect a path graph $(P_m)$ of length $m$ to $v$. In other words we add $m$ vertices $v_1, v_2, ..., v_m \in V'$ and $vv_1, v_1v_2,...,v_{m-1}v_m \in E'$ for every vertex $v$.

For even $d = 2m$, first add a path graph of $m$ vertices as described above to every vertex $v \in V$. Then also, for every vertex $v \in V$, if there exists a vertex $u \in V$ such that $u \in N[v]$ in $G$ then add $v_1u \in E'$ where $v_1$ is the first vertex of the path graph which is connected to vertex $v$.


\begin{figure}[h!]
	\centering
	\begin{tikzpicture}[yscale = 1, xscale = 1]
		\draw [black] (0,0) circle (0.5);
		\draw [black] (0,-3) circle (0.5);
		\draw [black] (3,0) circle (0.5);
		\draw [black] (-3,3) circle (0.5);

		\draw [thick, black] (0.5,0) -- (2.5,0);		
		\draw [thick, black] (0,-0.5) -- (0,-2.5);		
		\draw [thick, black] (0.5,0) -- (2.5,0);		
		\draw [thick, black] (0.5,0) -- (2.5,0);		



		% \draw [black] (4,0) circle (0.5);
		% \draw [black] (8,0) circle (0.5);
		% \draw [black] (6,-3) circle (0.5);
		% \draw [black] (2,-3) circle (0.5);

		% \draw [thick, ->, black] (0.5,0) -- (3.5,0);
		% \draw [thick, ->, black] (4.5,0) -- (7.5,0);
		% \draw [thick, ->, black] (7.75,-0.433) -- (6.25,-3.0 + 0.433);
		% \draw [thick, ->, black] (5.5,-3) -- (2.5,-3);
		% \draw [thick, ->, black] (1.75,-3 + 0.433) -- (0.25,-0.433);

		% \draw [thick, ->, black] (6.25, -3.433) to [out=-45, in = -85] (7, -3) to [out=85, in=45] (6.24, -3.0 + 0.433);

		% \node [above] at (0,0) {$p1$};
		% \node [below] at (0,0) {NCS};
		% \node at (4,0) {$p2$};
		% \node at (8,0) {$p3$};
		% \node at (6,-3) {$p4$};
		% \node [above] at (2,-3) {$p5$};
		% \node [below] at (2,-3) {CS};

		% \node at (4,-1.2) {\textbf{p}};
		% \draw [black] (4,-1.2) circle (0.2);
		% \node [above] at (2,0) {b[0] := true};
		% \node [above] at (6,0) {tmp0 := turn[1]};
		% \node [right] at (7.2,-1.5) {turn[0] := tmp0};
		% \node [above] at (4,-2.6) { ( b[1] = false $\lor$ tmp0 $\neq$ turn[1] ) };
		% \node [left] at (0.8,-1.5) {b[0] := false};

		% \node [above right] at (7,-3) {( b[1] = true $\land$};
		% \node [below right] at (7,-3) {tmp0 = turn[1] )};
	\end{tikzpicture}
\end{figure}


% In other words, given any instance $(G=(V,E), k)$ of \textsc{Independent Set}, we describe an FPT algorithm that contructs an equivalent instance $(G'=(V',E'), k')$ of $d$-\textsc{Packing}.

% First, set $k' \leftarrow k$. For odd $d=2m+1 \ge 1$ where $m$ is some natural number, we replace the edge between all pairs of distinct vertices $(u, v)$ by a path graph on $m$ vertices ($P_m$) by connecting each respective endpoint of the path graph to a vertex $u, v$. In other words, we add $m$ vertices $w_1, w_2, \dotsc, w_m \in V'$ for each pair $(u, v)$ of adjacent vertices, remove the original edge $uv$, and add edges $uw_1, w_1w_2, \dotsc, w_mv \in E'$.

% For even $d=2m$, we first add $m$ vertices for all pairs of adjacent vertices as before. For edge $i$ denote its added vertices $V_{i} = \{w_{i1}, w_{i2}, \dotsc, w_{im}\}$ for $i \in \{1, 2, \dotsc, |E|\}$ and let $V' = V \cup V^{*}$ where $V^{*} = \bigcup_{i=1}^{|E|} V_i$. Then for each pair of vertices $(u, v) \in V_i \times V_j$ where $i \ne j$, we add a path graph on $2m-2 = d-2$ vertices. In other words, we add a path with $d-2$ vertices between vertices $w_{ip}$ and $w_{jq}$ where $i\ne j$, and hence a path of length $d-1$. Let us call the vertices added between pairs of adjacent vertices in $G$ (where we added $m$ vertices) the First Addition, and the vertices added between all pairs of First Addition vertices (in the new $d-1$ vertices) the Second Addition.

% To help aid our proof, we make the assumption that both $G'$ and $G$ do not contain isolated vertices. This case can easily be taken care of since if in $(G,k)$, $x$ is an isolated vertex then both \textsc{Packing} and \textsc{Independent Set} have the same simplification of $(G\bs\{x\},k-1)$.

% Now we show that $(G, k)$ is a \textsc{Yes}-instance for \textsc{Independent Set} iff $(G', k')$ is a \textsc{Yes}-instance for $d$-\textsc{Packing}:

% \begin{itemize}
% 	\item ($\Rightarrow$) Let $S$ be an independent set of size $k$ in $G$. Then, for odd $d$, the distance between any two distinct vertices $(u, v)$ in $S$ in $G'$ is at least $2(m+1)=d+1$ since $uv \notin E$. So if there was one vertex on a path between $u, v$ in $G$, then there are now $d+1$ vertices on a path between them in $G'$. Therefore, $S$ is a $d$-packing of size $k'$ in $G'$ for some odd $d$. For even $d$, \dots

% 	% For even $d$,  if two vertices were originally not neighbours, they are now of distance $d-1 + 2 = d+1$ apart. Hence, $S$ is a $d$-\textsc{Packing} of $G'$ since the distance between any pair of the vertices of $S$ in $G'$ is at least $d+1$.
% 	\item ($\Leftarrow$) Let us first consider the even case for $d = 2m$. Suppose $S$ is a $d-$packing of size $k'$ in $G'$. For any two arbitrary vertices $u,v$ we consider in what cases they can both belong to $S$
% 	\begin{enumerate}
% 		\item $u,v \in V$: The two vertices are from the original graph $G$. If $u$ and $v$ were adjacent to each other in $G$ then notice that the distance from $u$ to $v$ is now $m+1 < 2m+1$ since we added replaced edges with $m$ vertices on a path. In other words, both $u,v$ cannot be in $S$ if they were previously adjacent
% 		\item $u \in V$, $v \in$ First Addition: $u$ belongs to a vertex in $G$ and $v$ is one of the $m$ vertices added in the First Addition. Due to the vertices of the Second Addition, there is a path from $v$ to any $v' \in$ First Addition of path length $d-1$. Let $v'$ be a First Addition vertex adjacent to $u$. Such a $v'$ must exist due to the assumption that we have no isolated vertices. But that means that there exists a path of length $d-1 + 1$ (from $v$ to $v'$ to $u$) between $u,v$ hence both $u,v$ cannot be in $S$.
% 		\item $u \in V$, $v \in $ Second Addition: This works a similar manner to above. There must exist a vertex $v' \in $ First Addition such that $u, v'$ are adjacent. $v$ and $v'$ are at most $d-2 / 2 < d - 1$ distance away. The addition of these two paths will not result in a path greater than $d$ hence once again, both $u,v$ cannot be in $S$
% 		\item $u,v \in$ First Addition: By the addition of the $d-1$ length path by Second Addition, this case cannot occur.
% 		\item $u \in$ First Addition, $v \in$ Second Addition.
% 	\end{enumerate}
% \end{itemize}

% The reduction is clearly FPT (even polynomial) since $k' \leq k$ and the running time of the reduction is $f(k) \cdot |I|^{\mcO(1)} = n^{\mcO(1)}$ since $f(k)=c$ and $|I| = n$.

% Since there is a parameterized reduction from \textsc{Independent Set}, the $d$-\textsc{Packing} problem is $W[1]$-hard for parameter $k$. 

\section{\sc Packing \textnormal{is FPT for parameter $d + tw(G)$}}

We formalize the property of a graph having a $d$-packing of size $k$ in Monadic Second Order Logic (MSOL) using a formula of length $\mcO(d)$,
\begin{align*}
	\mathrm{path}(s, t, d) 		&\coloneqq \exists v_0 \in V, \exists v_1 \in V, \dotsc, \exists v_d \in V
									\left [ (s=v_0) \wedge (t=v_d) \right.\nonumber \\
								&\qquad \left. \wedge (adj(v_0, v_1) \wedge adj(v_1, v_2) 
									\wedge \dots \wedge adj(v_{d-1}, v_d)) \right ] \\
	\mathrm{isPacking}(X, d)	&\coloneqq \neg \left [\exists u \in X, \exists v \in X (\mathrm{path}(u, v, 1) 
									\vee \mathrm{path}(u, v, 2) \vee \dots \vee \mathrm{path}(u, v, d) ) \right ]
\end{align*}

In Arnborg et al.'s \cite{Arnborg1991} extension of Courcelle's Theorem gives us an FPT algorithm which takes as an input a graph $G$ and a Monadic Second Order sentence $F(X)$ and computes a minimize size set of vertices $X$ such that $F(X)$ is true in $G$. Here the parameter used to calculate the parameterized complexity is $|F(X)| + tw(G)$. 

In \textsc{Packing} we return whether or not a $d-$packing of size $k$ on a graph $G$ with treewidth $tw(G)$ exist. This can be achieved by acquiring $X$, the minimize size of a a $d-$packing in a graph $G$ with treewidth $tw(G)$ by Arnborg's FPT extension of Courcelle's Theorem using the MSOL sentence isPacking$(G,d)$. Once this minimum size $d-$packing $X$ is acquired, then a simple check if $|X| \leq k$ will ensure that a $d$-packing of size $k$ exists for $G$. If $|X| > k$ then $G$ does not have a $k$ sized $d-$packing.

% \todo{Discussion: Set cardinality is technically not a part of MSOL. Of course we can define it, but the length of the formula is $\mcO(k^2)$.}

% By Courcelle's Theorem, deciding whether a graph satisfies the properties defined by a MSOL formula is FPT, parameterized by the treewidth of $G$ and the length of the formula, which in our case is $\mcO(d)$.

The usage of Arnborg's FPT extension of Courcelle's theorem with the MSOL sentence isPacking$(G,d)$ guarantees that finding a satisfying minimum size graph $X$ is FPT, parameterized by $tw(G) + |$isPacking$(G,d)| = tw(G) + d$. As checking if $|X| \leq k$ is a constant time operation therefore it immediately follows that \textsc{Packing} is FPT for parameter $d+tw(G)$ where $tw(G)$ denotes the treewidth of $G$.

\bibliographystyle{plain}
\bibliography{asst2}

\todo{Thanks to mendeley, the references are actually kinda shit. fix this up if we have time}

\end{document}