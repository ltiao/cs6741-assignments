\documentclass[10pt, a4paper]{article}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{epsfig}
\usepackage[margin=1in]{geometry}
%\usepackage{enumitem}
\usepackage{enumerate}
\usepackage{graphicx}
\usepackage{tikz}
\usetikzlibrary{automata, positioning}
% \usepackage{pgfplots}
\usepackage{caption}
\usepackage{mathtools}
\usepackage{titling}
\usepackage[lined,boxed,commentsnumbered,vlined]{algorithm2e}

\usepackage{todonotes}

% For writing code:
\usepackage{fancyvrb}
\DefineVerbatimEnvironment{code}{Verbatim}{fontsize=\small}
	\def\showvrb#1{%
	\texttt{\detokenize{#1}}%
}

\usepackage{cleveref}

\linespread{1.1}
\setlength{\parindent}{0pt} % Sets the indent length to 0
\setlength{\parskip}{8pt plus 1pt minus 1pt} % paragraph vertical distance

% \everymath{\displaystyle} % displays inline math as displaymath

% make title smaller
% \pretitle{\begin{center}\large}
% \posttitle{\end{center}}
\preauthor{\begin{center}\normalsize}
\postauthor{\end{center}}
\predate{\begin{center}\footnotesize}
\postdate{\end{center}}
\setlength{\droptitle}{-60pt}

\title{Assignment 2 - Theoretical Assignment \\
 COMP6741: Parameterized and Exact Computation}
\author{Edward Lee, Han Zhao, Louis Tiao}

%%%%%%%%%%%%%%%%%%%%%%%%%%
% Commonly used theorems %
%%%%%%%%%%%%%%%%%%%%%%%%%%

% Use roman for text - numbering follows onwards
\theoremstyle{definition}
\newtheorem{defn}{Definition}[section]
\newtheorem{them}{Theorem}[section]
\newtheorem{lem}{Lemma}[them]
\newtheorem{prop}[them]{Proposition}
\newtheorem{corr}[them]{Corollary}
\newtheorem{corrr}{Corollary}[them] %for consistency issues
% examples follow different numbering
\newtheorem{eg}{Example}[section]
\newtheorem{egg}[them]{Example}
\newtheorem*{themf}{Theorem 5.0}
\newtheorem*{themm}{Theorem}

%%%%%%%%%%%%%
% Shortcuts %
%%%%%%%%%%%%%

\newcommand{\Q}{\mathbb{Q}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\F}{\mathbb{F}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\D}{\mathbb{D}}

\newcommand{\mcC}{\mathcal{C}}
\newcommand{\mcN}{\mathcal{N}}
\newcommand{\mcE}{\mathcal{E}}
\newcommand{\mcP}{\mathcal{P}}
\newcommand{\mcF}{\mathcal{F}}
\newcommand{\mcS}{\mathcal{S}}
\newcommand{\mcA}{\mathcal{A}}
\newcommand{\mcB}{\mathcal{B}}
\newcommand{\mcX}{\mathcal{X}}
\newcommand{\mcL}{\mathcal{L}}
\newcommand{\mcH}{\mathcal{H}}
\newcommand{\mcl}{\mathcal{l}}
\newcommand{\mcU}{\mathcal{U}}

\newcommand{\mcI}{\mathcal{I}}
\newcommand{\mcO}{\mathcal{O}}

\newcommand{\bfe}{\mathbf{e}}
\newcommand{\mbf}{\mathbf}

\newcommand{\ran}{\mbox{Ran}}
 
\newcommand{\al}{\alpha}
\newcommand{\s}{\sigma}
\newcommand{\ep}{\epsilon}
\newcommand{\dl}{\delta}
\newcommand{\sg}{\sigma}

\newcommand{\bs}{\backslash}
\newcommand{\n}{\\}
\newcommand{\ol}{\overline}

%%%%%%%%%%%%%%%%%%%%%%%%%
% Standard big brackets %
%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\floor}[1]{\left\lfloor{#1}\right\rfloor}
\newcommand{\ceil}[1]{\left\lceil{#1}\right\rceil}
\newcommand{\bbA}[1]{\left({#1}\right)}
\newcommand{\bbB}[1]{\left[{#1}\right]}
\newcommand{\bbC}[1]{\left\{{#1}\right\}}

%%%%%%%%%%%%%%%%%%
% Start Document %
%%%%%%%%%%%%%%%%%%

\begin{document}
\maketitle

\todo{Consistency between British and American spelling (i.e. colour vs. color)}
\todo{Spellcheck}

\section*{Preliminaries}

For completeness and later reference, we restate the \textsc{Packing}, $d$-\textsc{Packing}, \#\textsc{Packing} and \textsc{Packing Colouring} problems presented in this assignment.

For an integer $d \geq 0$, a \emph{d-packing} in a graph $G = (V,E)$ is a subset of vertices $S \subseteq V$ such that the distance between any two vertices in $S$ is at least $d$ + 1 in $G$. Denote $d(u,v)$ as the distance between $u,v \in V$.

\begin{algorithm}[H]
\textsc{Packing\n}
\begin{tabular}{l l}
 Input:    & A graph $G$, an integer $d \geq 0$, and an integer $k \geq 0$ \n
 Question: & Does $G$ have a $d$-packing of size $k$? \n
\end{tabular}	
\end{algorithm}

For a fixed integer $d$, 

\begin{algorithm}[H]
\textsc{$d$-Packing\n}
\begin{tabular}{l l}
 Input:    & A graph $G$, and an integer $k \geq 0$ \n
 Question: & Does $G$ have a $d$-packing of size $k$? \n
\end{tabular}	
\end{algorithm}

The counting variant requires the output of the number of $d$-packings in $G$

\begin{algorithm}[H]
\textsc{\#Packing\n}
\begin{tabular}{l l}
 Input:    & A graph $G$, and an integer $d \geq 0$\n
 Question: & The number of $d$-packings in $G$ \n
\end{tabular}	
\end{algorithm}

For a sequence of $k$ non-negative integers $D = (d_1,...,d_k)$, a \emph{D-packing colouring} of a graph $G = (V,E)$ is a partition of the vertex set $V$ into $k$ disjoint sets of vertices, $(S_1,...,S_k)$, such that $S_i$ is a $d_i$-packing in $G$ for each $i \in \{1,...,k\}$. The \textsc{Packing Colouring} problem is defined below

\begin{algorithm}[H]
\textsc{Packing Colouring\n}
\begin{tabular}{l l}
 Input:    & A graph $G$, an integer $k \geq 1$, and a sequence of non-negative integers $D = (d_1,...,d_k)$ \n
 Question: & Does $G$ have a $D$-packing colouring? \n
\end{tabular}	
\end{algorithm}

\clearpage

\section{\#\sc Packing}

\todo{Formalize and Proofread}

Consider a graph $G = (V, E)$ and let $n = |V|$.

First note that in any graph, the distance between any two distinct vertices is at least 1. Therefore, any subset of vertices $S \subseteq V$ is a $0$-packing, of which there are $2^n$. So for $d=0$, we need only calculate $|V|$ and $2^{|V|}$, which can be done in $\mcO(n)$ time and space.

Denote \texttt{\#Indep-set} the polynomial space and $\mcO^*(1.2377^n)$ time algorithm of Wahlstr\"{o}m \cite{Dahllof2005,Wahlstr2008} that counts the number of independent sets in any graph.

If $d = 1$, then 's algorithm \cite{Dahllof2005,Wahlstr2008} guarantees that a polynomial amount of space is taken and the time complexity if . Furthermore, since \#\textsc{Independent Set} is a polynomial space branching algorithm, then this case of \textsc{\# Packing} is also a polynomial space branching algorithm.

If $d \geq 2$ then we create a new graph $G'$ be adding in edges between two vertices who have a distance less than or equal to $k$. Then any two vertices which do not share an edge in $G'$ must be of distance $d+1$ or greater apart. Notice that the time complexity of adding the new edges is at most $O(n \times n^d) = O(n^{d+1})$ since for each vertex, a search for vertices of distance less or equal to than $d$ can branch no more than $n-1 \leq n$ times, to a depth of no more than $d$. As any independent set in $G'$ is thus a $d$-packing in $G$ then transforming $G$ to $G'$ and then running Wahlstr\"{o}m's \#\textsc{Independent Set} counts the number of $d$-packings in time $O(n^{d+1}) + O^*(1.2377^n) = O^*(1.2377^n)$ as $d$ is fixed. Since the extra computation to transform $G$ to $G'$ requires only $O(n^{d+1})$ time then at most it requires polynomial space. As \#\textsc{Independent Set} is a polynomial space branching algorithm then to solve for the case $d \geq 2$ we also have a polynomial space branching algorithm.

The above is summarized in the polynomial space branching algorithm \ref{algo:num_packing}.

\begin{algorithm}[H]
\caption{\texttt{\#Packing}}          % give the algorithm a caption
\label{algo:num_packing} 
\texttt{\#Packing\n}
\begin{tabular}{l l}
 Input:  & ($G,d$) \n
 Output: & Number of $d$-packings in $G$ \n
\end{tabular}	

\If{$d = 0$}{
	\textbf{return} $2^n$
}
\If{$d = 1$}{
	\textbf{return} \texttt{\#Indep-set}($G$)
}
\If{$d \geq 2$}{
	Create a new graph $G' = (V,E')$ where $E' = E \cup E^*$ and $uv \in E^*$ if $d(u,v) \leq k$ in $G$.\n
	\textbf{return} \texttt{\#Indep-set}($G'$)
}

\end{algorithm}

Therefore, \dots

\section{\sc Packing Colouring  (\textnormal{Exponential space})}

First note that a $k$-coloring of a graph is a special case of a $D$-packing coloring 
where $D = (d_1, d_2, \dotsc, d_k) = (1, 1, \dotsc, 1)$. As such, we can consider extending
the solution to the \textsc{Coloring} problem to solve the \textsc{Packing Coloring} problem.

Recall that a $k$-coloring of a graph $G = (V, E)$ corresponds to a partition of $V$ into $k$ independent sets. So a $k$-coloring is a $k$-partition of the set system $(V, \mcI)$ where $\mcI$ is the set of all independent sets of $G$. In fact, obtaining $k$-cover $(I_1, \dotsc, I_k)$ of $(V, \mcI)$ would suffice since we can easily obtain a $k$-partition of $(V, \mcI)$ (and hence $k$-coloring of $G$) by removing $\bigcup_{i=1}^{j-1} I_i$ from $I_j$ for $j \in \{1, \dotsc, k\}$.

Now consider the \textsc{Packing Coloring} problem. Denote $\mcP_i$ as the set of all $d_i$-packings of $G$ and $\mcP = \bigcup_{i=1}^{k} \mcP_i$. Then a graph $G = (V, E)$ has a $(d_1, \dotsc, d_k)$-packing coloring if and only if there exists a $k$-cover $(S_1, \dotsc, S_k)$ of $(V, \mcP)$ such that $S_i$ is a $d_i$-packing. We can obtain $k$-partition (and hence a $D$-packing coloring of $G$) as before, since like independent sets, $d$-packings are closed under set difference.

Let $U$ be the set of tuples $(S_1, \dotsc, S_k)$, where each $S_i$ is a $d_i$-packing and $A_v = \{ (S_1, \dotsc, S_k) \in U : v \in \bigcup_{i=1}^{k} S_i\}$. Clearly $G$ has a $D$-packing coloring if and only if $\left | \bigcap_{v \in V} A_v \right | > 0$.

To compute $\left | \bigcap_{v \in V} A_v \right |$, we use the inclusion-exclusion theorem (c.f. Theorem 4.2 in \cite{Fomin2010}):
\begin{equation} \label{eq:incl_excl}
	\left | \bigcap_{v \in V} A_v \right | = \sum_{S \subseteq V} (-1)^{|S|} \left | \bigcap_{v \in S} \overline{A_v} \right | 
\end{equation}

So by extension, we simply need to compute 
\begin{align*}
	\left | \bigcap_{v \in S} \overline{A_v} \right | &= \left | \{ (S_1, \dotsc, S_k) \in U : S_1, \dotsc, S_k \subseteq V \setminus S \} \right | \\
													  &= \prod_{i=1}^{k} p(V \setminus S, d_i)
\end{align*}

where $p(X, d)$ is the number of $d$-packings in $G[X]$ (the subgraph induced by vertex subset $X$) and can be defined by the following dynamic programming recurrence:
\begin{align*}
	p(\emptyset, d) &= 1 \\
	p(X, d) &= \sum_{v \in X} p(X \setminus {v}, d) + p(X \setminus N_G^d[v], d)   
\end{align*}

(n.b. $N_G^i[v]$ denotes the closed $i$th neighborhood of $v$, that is, $u \in N_G^i[v]$ iff $d(u, v) \leq i$.) The table for $p(X, d)$ is filled by increasing cardinalities of $X$ and therefore we compute it in $\mcO^*(2^n)$ time and space. 

Finally, we evaluate

\begin{equation} \label{eq:incl_excl_final}
	\left | \bigcap_{v \in V} A_v \right | 
	= \sum_{S \subseteq V} (-1)^{|S|} \left | \bigcap_{v \in S} \overline{A_v} \right | 
	= \sum_{S \subseteq V} (-1)^{|S|} \prod_{i=1}^{k} p(V \setminus S, d_i)
\end{equation}

in $\mcO^*(2^n)$ time and space. We can decide whether $G$ has a $D$-packing coloring by checking that $G$ has at least one $D$-packing coloring ($\left | \bigcap_{v \in V} A_v \right | > 0$). Therefore, \textsc{Packing Coloring} can be solved in $\mcO^*(2^n)$ time and space.

\section{\sc Packing Colouring (\textnormal{Polynomial space})}

We make use of the algorithm from (1) (based on the algorithm by \cite{Wahlstr2008,Dahllof2005}) that counts the number of $d$-packings in a given graph $G$ and integer $d \ge 0$ in $\mcO^*(1.2377^n)$ time and polynomial space. Then, we obtain a polynomial space algorithm for \textsc{Packing Coloring} with running time
\begin{equation*}
	\sum_{S\subseteq V} \mcO^*(1.2377^{n-|S|}) = \sum_{s=0}^n \binom{n}{s} \mcO^*(1.2377^{n-s}) = \mcO^*(2.2377^n)
\end{equation*}

Therefore, \textsc{Packing Coloring} can be solved in $\mcO^*(2.2377^n)$ time and polynomial space.

\section{\sc Packing \textnormal{is FPT for parameter $k + d + \Delta (G)$} }

\todo{Formalize and Proofread}

From (1) we can reduce \textsc{Packing} to \textsc{Independent set} in poly-time with parameter $d$. We know that Independent set and Vertex cover can easily be reduced, but with a parameter $k$, Independent set is $W[1]$-hard and not FPT since we are looking for a vertex cover of size $n-k$. However, since we have $\Delta(G)$ as a parameter, we just run \textsc{Vertex Cover} with size $\Delta(G) \times k$, which is still FPT in parameter $k + d + \Delta(G)$.

\section{$d$-\sc Packing \textnormal{is $W[1]$-hard for parameter $k$}}

\todo{Formalize and Proofread}

Reduction to \textsc{Independent Set}. For $d$ odd, add in $d-1/2$ new vertices between each edge and run $d$-\textsc{Packing}. Map intermediate vertices back to closest ``original'' vertices if selected. This is a solution to $d=1$ packing, and hence independent set (since they are the same). Notice that we may match an added vertex with another added vertex, but it will preserve the fact that we get a YES case after the reduction if prior to it, it was a YES case.

For $d = 2k$ even, add in $d/2$ new vertices on paths between any two original vertices. Then for each of these added vertices, add in a path of length $d-1 = 2k-1$ between add ADDED vertices. Now, notice that between any two original vertices which were adjacent, they are of distance $d/2 + 1$, but if they were not neighbors, they are now of distance $d-1 + 2 = d+1$ apart. It can be left an an exercise to the read to prove that this is correct.

\section{\sc Packing \textnormal{is FPT for parameter $d + tw(G)$}}

We formalize the property of a graph having a $d$-packing of size $k$ in Monadic Second Order Logic (MSOL) using a formula of length $\mcO(d)$,
\begin{align*}
	\mathrm{path}(s, t, d) 		&\coloneqq \exists v_0 \in V, \exists v_1 \in V, \dotsc, \exists v_d \in V
									\left [ (s=v_0) \wedge (t=v_d) \right.\nonumber \\
								&\qquad \left. \wedge (adj(v_0, v_1) \wedge adj(v_1, v_2) 
									\wedge \dots \wedge adj(v_{d-1}, v_d)) \right ] \\
	\mathrm{isPacking}(X, d)	&\coloneqq \neg \left [\exists u \in X, \exists v \in X (\mathrm{path}(u, v, 1) 
									\vee \mathrm{path}(u, v, 2) \vee \dots \vee \mathrm{path}(u, v, d) ) \right ] \\
	\mathrm{Packing} 			&\coloneqq \exists X \subseteq V [(|X| = k) \wedge \mathrm{isPacking}(X, d)]
\end{align*}

\todo{Discussion: Set cardinality is technically not a part of MSOL. Of course we can define it, but the length of the formula is $\mcO(k^2)$.}

By Courcelle's Theorem, deciding whether a graph satisfies the properties defined by a MSOL formula is FPT, parameterized by the treewidth of $G$ and the length of the formula, which in our case is $\mcO(d)$.

Therefore, it immediately follows that \textsc{Packing} is FPT for parameter $d+tw(G)$ where $tw(G)$ denotes the treewidth of $G$.

\bibliographystyle{plain}
\bibliography{asst2}

\todo{Thanks to mendeley, the references are actually kinda shit. fix this up if we have time}

\end{document}